os: linux
dist: xenial
language: python
python:
- '3.8'
cache: pip
install:
- pip install -r requirements.txt
- pip install coveralls
script:
- python manage.py collectstatic --no-input
- python manage.py makemigrations
- python manage.py migrate
branches:
  only:
  - postgres
after_success:
- coverage run manage.py test
- coveralls
after_failure:
- echo "Deployment failed"
deploy:
  provider: heroku
  cleanup: true
  api_key:
    secure: IYay2rMUahLL530CJZPumCXKmBKF4gM+zAFbN8lHs18Bn/ZUFQ0jg79fmm2QUoIIxZOKtJZnTOkaEXZSe6rXdLfzg6SY4byrI3nGquwgMX6TxUqF+48cGYD/R6sUoorG7iD9hk5RNsfISAFbM53ytBc4N6BXuoaI4t9KaIEjHMVQQ5hmjeaNbmjD65hNmACS3y+84wYWQGIZyv72VFsCjAwofYJhZHpW6JsIIV7SDirqXL0pyLhgYZecFpY1/UbDATPlLAcx9HPqrL1abqZoHd/rFGzhbnnw5vAxwdquIVefoLPbIcbtv5sdp5/0iolGlDpz10PmAQAgr3tNBYq8DhKcEzyMtZRQYd4kaZnhBeQFiCQSsmCA4m4s6rFd7kXmbk7LkC6ZBU+62qoVkxPU/JQMycx1/E/yeUuPQiuhF8kchNmlu0ranpSE0i5AGfilJMW9VIAzeaqI7Lb8s02fK1/bmOsjxwIUAga3pE60t/IMz5TXPXzLfGKND9Xwgfodyfb8UOCRia7pA+ACn8wiZpxxaHgvhj9XcAl2iSXAOd4HKWFW8HJ51YJElyeGxnWQiMTu9hl3JolwNPsfrWEC8tq4ttreSJGQRuO2b3nwfuA4bXmgeBIJvQ694LjVvoReePzaTlnZRSvdNlDv/OeIlE7pkfzZt7AKN//kLlUrJwI=
  app: pollcreator
  on: postgres
