os: linux
dist: xenial
language: python
python:
- '3.8'
cache: pip
install:
- pip install -r requirements.txt
- pip install coveralls
script:
- python manage.py collectstatic --no-input
- python manage.py makemigrations
- python manage.py migrate
branches:
  only:
  - postgres
after_success:
- coverage run manage.py test
- coveralls
after_failure:
- echo "Deployment failed"
deploy:
  provider: heroku
  cleanup: true
  api_key:
    secure: 1U9HeAbDg8mPLFWvenCfBIIor0ElCnm9XNGBrm6A0Ndhd8I0DLwflxLWA9iIghpmCmTOLucrGBKA5AVQ8UjtnV7AhHuy4ON5Vi/9BBnfjlmItfNK8wi12gJNCChsT2iagrkSjgg0aOF3nqhnwvKm6hmxm7n9cn5xEfjlZD34SrNN77Fo2aOfBUTxHQbqZS9OoBNJV85ZkwGBBBX9cGNAQI0GfzV4L8FKGFDy2hyia/H4OVfkNGx1gF7tbG6U2EFbHncXSYckdZ7W8JAsaQPfwMAbZx5FPEtdrXa/3mSwETHMI7dHCC017ohNVy4ZMi0ClwEbK+Ei27sKXOADPSWZrlHiHee/qA+h/wp3jOD0si4pnLfuWLTZ4PPonKB8/ld0YIZX3czufbhFdW0U4IE4IZSBptJamWWn00asOJAhUxftG1kTGzCJ0Qugrk5gGYh0mTAC7RMh5Z3ZogBibxpZcdhtiTfMHpo/Eog+0/dWpSnErel2NDv8BM3WJf5uaOPzkF08T97JL+vKZn+4om/VSDBl9T8/beysfg2nZx6yk67E8sAjzGnAqjZwpGMPQpO9K4xhykQHHam/5IpNFfKAMEqRd97Kw6WpfThN+7oIuqzqmi7Z2lo/g6lQNo35E+PQGT8bmrSZBhOh3scs0C90jQwm6Iyd0bYsPW3y17aGrV8=
  app: pollcreator
  on: postgres
